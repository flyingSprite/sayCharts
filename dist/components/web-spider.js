"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{"default":t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var s=e[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,r,s){return r&&t(e.prototype,r),s&&t(e,s),e}}(),_multiLayout=require("./multi-layout.js"),_multiLayout2=_interopRequireDefault(_multiLayout),WebSpider=function(){function t(e){_classCallCheck(this,t),this.director=e,this.center={x:this.director.width/2,y:this.director.height/2},this.scale=1,this.dx=this.center.x,this.dy=this.center.y,this.segments=12,this.r=this.center.x>this.center.y?this.center.y:this.center.x,this.defaultTierR=40,this.tierR=30,this.tiers=(this.r-this.defaultTierR)/this.tierR,this.layout=(new _multiLayout2["default"]).centerLayout(this.director),this.initPositions(),this.dashedBranchCreator(this.posititions,this.segments,this.tiers),this.dashedTierCreator(this.posititions),this.dashedPointCreator(this.posititions),this.zoom(),this.drag()}return _createClass(t,[{key:"drag",value:function e(){var t=this,e=(this.center.x,this.center.y,d3.behavior.drag().on("drag",function(e){t.dx+=d3.event.dx,t.dy+=d3.event.dy,t.layout.attr("transform","translate("+t.dx+", "+t.dy+")scale("+t.scale+")")}));this.director.scene.call(e)}},{key:"zoom",value:function r(){var t=this,r=d3.behavior.zoom().scaleExtent([.1,10]).on("zoom",function(){t.scale=d3.event.scale,t.layout.attr("transform","translate("+t.dx+", "+t.dy+")scale("+t.scale+")")});this.director.scene.call(r)}},{key:"initPositions",value:function(){for(var t={center:{x:0,y:0},branchs:[],nodes:[]},e=0;e<this.segments;e++){var r=2*Math.PI/this.segments*e,s={x:this.r*Math.cos(r),y:this.r*Math.sin(r)};t.branchs.push(s)}for(var e=0;e<this.tiers;e++){for(var i=[],a=this.tierR*e+this.defaultTierR,n=0;n<this.segments;n++){var r=2*Math.PI/this.segments*n,o={x:a*Math.cos(r),y:a*Math.sin(r)};i.push(o)}t.nodes.push(i)}this.posititions=t}},{key:"dashedBranchCreator",value:function(t,e,r){for(var s=t.branchs,i=t.nodes,a=[],n=0;r>n;n++)for(var o=0;e>o;o++){var h=0===n?{x:0,y:0}:i[n-1][o],l=i[n][o],d=this.dashednetBeelineCreator(h,l);a.push(d)}for(var c=i[i.length-1],o=0;e>o;o++){var h=c[o],l=s[o],d=this.dashednetBeelineCreator(h,l);a.push(d)}}},{key:"dashednetBeelineCreator",value:function(t,e){var r={one:t,two:e,path:this.layout.append("polyline").attr("points",[[t.x,t.y],[e.x,e.y]])};return r}},{key:"dashedTierCreator",value:function(t){for(var e=t.nodes,r=[],s=0;s<e.length;s++){for(var i=e[s],a=i[0],n=!0,o=0;o<i.length;o++){var h=i[o];if(n)n=!1;else{var l=this.dashednetBeelineCreator(a,h);a=h,r.push(l)}}var l=this.dashednetBeelineCreator(i[0],i[i.length-1])}}},{key:"dashedPointCreator",value:function(t){for(var e=t.nodes,r=[],s=0;s<e.length;s++)r=r.concat(e[s]);for(var i=[],s=0;s<r.length;s++){var a=this.dashednetNodeCreator(r[s]);i.push(a)}}},{key:"dashednetNodeCreator",value:function(t){var e={positition:t,point:this.layout.append("circle").attr("class","node-dashednet").attr("cx",t.x).attr("cy",t.y).attr("r",5)};return e}}]),t}();exports["default"]=WebSpider;